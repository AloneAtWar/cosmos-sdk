# 快速入门

<cite>
**本文档中引用的文件**
- [README.md](file://README.md)
- [simapp/README.md](file://simapp/README.md)
- [simapp/app.go](file://simapp/app.go)
- [simapp/simd/main.go](file://simapp/simd/main.go)
- [simapp/simd/cmd/root.go](file://simapp/simd/cmd/root.go)
- [simapp/simd/cmd/commands.go](file://simapp/simd/cmd/commands.go)
- [simapp/simd/cmd/testnet.go](file://simapp/simd/cmd/testnet.go)
- [Makefile](file://Makefile)
- [scripts/init-simapp.sh](file://scripts/init-simapp.sh)
</cite>

## 目录
1. [简介](#简介)
2. [系统要求](#系统要求)
3. [环境设置](#环境设置)
4. [克隆仓库](#克隆仓库)
5. [构建应用程序](#构建应用程序)
6. [初始化开发环境](#初始化开发环境)
7. [创建第一个区块链](#创建第一个区块链)
8. [使用CLI进行基本操作](#使用cli进行基本操作)
9. [运行测试网络](#运行测试网络)
10. [常见问题解答](#常见问题解答)
11. [下一步](#下一步)

## 简介

Cosmos SDK 是一个模块化的开源区块链开发框架，用于构建安全、高性能的第一层区块链。本指南将引导您从零开始，通过构建一个简单的 `simd` 示例应用来学习 Cosmos SDK 的基本概念和操作。

### 什么是 simd？

`simd` 是 Cosmos SDK 提供的一个模拟应用程序，它展示了如何使用 SDK 构建一个完整的区块链应用。这个应用包含了所有标准的区块链功能模块，是学习和测试的理想起点。

### 学习目标

完成本指南后，您将能够：
- 设置 Cosmos SDK 开发环境
- 克隆和构建 SDK 仓库
- 使用 `simd` 命令行工具
- 创建和管理本地测试网络
- 执行基本的区块链操作

## 系统要求

在开始之前，请确保您的系统满足以下要求：

### 最低要求
- **操作系统**: Windows 10/11、macOS 10.14+ 或 Linux (Ubuntu 18.04+)
- **内存**: 至少 4GB RAM
- **存储空间**: 至少 10GB 可用磁盘空间
- **网络**: 稳定的互联网连接

### 推荐配置
- **CPU**: 多核处理器
- **内存**: 8GB 或更多 RAM
- **存储**: SSD 存储设备

### 必需软件

#### 1. Go 编程语言
Cosmos SDK 是用 Go 编写的，因此需要安装 Go：

```bash
# 检查 Go 版本
go version

# 如果未安装或版本过旧，请访问 https://go.dev/dl/ 下载最新版本
```

#### 2. Git 版本控制
```bash
# 检查 Git 版本
git --version

# 如果未安装，请访问 https://git-scm.com/downloads 获取安装包
```

#### 3. Make 工具
大多数操作系统都预装了 Make：
```bash
# 检查 Make 版本
make --version
```

## 环境设置

### 1. 设置 Go 环境

首先，确保正确配置 Go 环境变量：

```bash
# 设置 GOPATH（如果尚未设置）
export GOPATH=$HOME/go
export PATH=$PATH:$GOPATH/bin

# 在 Windows 上：
# set GOPATH=%USERPROFILE%\go
# set PATH=%PATH%;%GOPATH%\bin
```

验证环境设置：
```bash
go env GOPATH
go env PATH
```

### 2. 配置 Git

设置您的 Git 用户信息：
```bash
git config --global user.name "Your Name"
git config --global user.email "your.email@example.com"
```

### 3. 创建工作目录

```bash
mkdir -p $GOPATH/src/github.com/yourusername
cd $GOPATH/src/github.com/yourusername
```

## 克隆仓库

### 1. 克隆 Cosmos SDK 仓库

```bash
# 克隆主仓库
git clone https://github.com/cosmos/cosmos-sdk.git
cd cosmos-sdk

# 查看可用分支
git branch -a
```

### 2. 验证克隆结果

```bash
# 检查当前分支
git branch

# 查看最近的提交记录
git log -n 3
```

**节源**
- [README.md](file://README.md#L1-L80)

## 构建应用程序

### 1. 使用 Make 构建

Cosmos SDK 使用 Make 来简化构建过程：

```bash
# 进入 SDK 目录
cd cosmos-sdk

# 构建 simd 应用程序
make build

# 构建完成后，simd 二进制文件将位于 build/ 目录
ls build/
```

### 2. 构建选项

```bash
# 清理之前的构建
make clean

# 安装到 GOPATH
make install

# 构建特定平台版本
make build-linux-amd64
make build-linux-arm64
```

### 3. 验证安装

```bash
# 检查 simd 版本
./build/simd version

# 或者如果您已安装到 PATH
simd version
```

**节源**
- [Makefile](file://Makefile#L115-L127)
- [simapp/simd/main.go](file://simapp/simd/main.go#L1-L21)

## 初始化开发环境

### 1. 使用预设脚本初始化

SDK 提供了一个便捷的脚本来初始化开发环境：

```bash
# 使用内置脚本初始化
make init-simapp

# 或手动执行以下步骤
./scripts/init-simapp.sh
```

### 2. 手动初始化步骤

如果您想了解每个步骤，可以手动执行：

```bash
# 删除现有配置（如果存在）
rm -rf ~/.simapp/

# 设置客户端配置
simd config set client chain-id demo
simd config set client keyring-backend test
simd config set client keyring-default-keyname alice
simd config set app api.enable true

# 创建密钥对
simd keys add alice
simd keys add bob

# 初始化节点
simd init test --chain-id demo

# 添加初始账户
simd genesis add-genesis-account alice 5000000000stake --keyring-backend test
simd genesis add-genesis-account bob 5000000000stake --keyring-backend test

# 创建创世交易
simd genesis gentx alice 1000000stake --chain-id demo

# 收集创世交易
simd genesis collect-gentxs
```

### 3. 验证初始化

```bash
# 检查配置文件
ls ~/.simapp/config/

# 查看节点信息
simd comet show-node-id
```

**节源**
- [scripts/init-simapp.sh](file://scripts/init-simapp.sh#L1-L19)
- [simapp/README.md](file://simapp/README.md#L15-L36)

## 创建第一个区块链

### 1. 启动节点

```bash
# 在后台启动节点
simd start &
```

### 2. 验证节点状态

```bash
# 检查节点是否运行
simd status

# 查看同步状态
curl -s localhost:26657/status | jq '.result.sync_info'
```

### 3. 停止节点

```bash
# 查找 simd 进程
ps aux | grep simd

# 终止进程（替换为实际 PID）
kill -9 <PID>
```

### 4. 使用配置文件启动

```bash
# 创建自定义配置
mkdir -p ~/.simapp/custom-config
cat > ~/.simapp/custom-config/app.toml << EOF
minimum-gas-prices = "0stake"
EOF

# 使用自定义配置启动
simd start --home ~/.simapp --config ~/.simapp/custom-config/app.toml
```

## 使用CLI进行基本操作

### 1. 密钥管理

```bash
# 列出所有密钥
simd keys list

# 显示特定密钥详情
simd keys show alice

# 导出密钥（谨慎使用）
simd keys export alice

# 删除密钥
simd keys delete alice
```

### 2. 查询操作

```bash
# 查询账户余额
simd q bank balances <your_address>

# 查询区块信息
simd q block

# 查询交易
simd q tx <tx_hash>

# 查询治理提案
simd q gov proposals
```

### 3. 发送交易

```bash
# 发送代币
simd tx bank send alice bob 1000stake \
  --from alice \
  --chain-id demo \
  --keyring-backend test \
  --gas 200000 \
  --gas-adjustment 1.2 \
  --gas-prices 0stake \
  -y
```

### 4. 验证器相关操作

```bash
# 创建验证人（仅在测试网络中）
simd tx staking create-validator \
  --amount=1000000stake \
  --pubkey=$(simd tendermint show-validator) \
  --moniker="my-validator" \
  --chain-id=demo \
  --commission-rate="0.10" \
  --commission-max-rate="0.20" \
  --commission-max-change-rate="0.01" \
  --min-self-delegation="1" \
  --from=alice \
  --keyring-backend=test \
  -y
```

**节源**
- [simapp/simd/cmd/root.go](file://simapp/simd/cmd/root.go#L26-L114)
- [simapp/simd/cmd/commands.go](file://simapp/simd/cmd/commands.go#L133-L237)

## 运行测试网络

### 1. 使用内置测试网络

```bash
# 启动 4 节点测试网络
simd testnet start --validator-count 4 --output-dir ./.testnets
```

### 2. 手动创建测试网络

```bash
# 初始化测试网络配置
simd testnet init-files \
  --validator-count 4 \
  --output-dir ./.testnets \
  --starting-ip-address 192.168.10.2 \
  --keyring-backend test
```

### 3. 启动测试网络

```bash
# 启动第一个节点
simd start --home ./.testnets/node0/simd &

# 启动其他节点
simd start --home ./.testnets/node1/simd &
simd start --home ./.testnets/node2/simd &
simd start --home ./.testnets/node3/simd &
```

### 4. 测试网络管理

```bash
# 检查节点状态
for i in {0..3}; do
  echo "Node $i:"
  curl -s localhost:$((26657 + $i * 2))/status | jq '.result.node_info.id'
done

# 停止所有节点
pkill simd
```

**节源**
- [simapp/simd/cmd/testnet.go](file://simapp/simd/cmd/testnet.go#L104-L200)

## 常见问题解答

### 1. 构建失败

**问题**: `make build` 失败，提示缺少依赖项

**解决方案**:
```bash
# 更新 Go 模块
go mod tidy

# 清理并重新构建
make clean
make build
```

**问题**: `go: module not found`

**解决方案**:
```bash
# 确保 GOPROXY 正确设置
go env -w GOPROXY=https://proxy.golang.org,direct

# 尝试重新下载依赖
go mod download
```

### 2. 配置错误

**问题**: `Error: unknown flag: --chain-id`

**解决方案**:
```bash
# 检查 simd 版本
simd version

# 如果版本过旧，重新构建
make build
```

**问题**: `Error: invalid chain-id`

**解决方案**:
```bash
# 重置配置
rm -rf ~/.simapp/
simd config set client chain-id demo
```

### 3. 网络连接问题

**问题**: 节点无法同步或连接失败

**解决方案**:
```bash
# 检查防火墙设置
sudo ufw allow 26656/tcp
sudo ufw allow 26657/tcp

# 检查端口占用
netstat -tulpn | grep :26656
```

### 4. 内存不足

**问题**: 运行测试网络时出现内存不足错误

**解决方案**:
```bash
# 减少验证人数量
simd testnet start --validator-count 2

# 或使用单节点模式
simd init test --chain-id demo
simd start
```

### 5. 权限问题

**问题**: `permission denied` 错误

**解决方案**:
```bash
# 检查文件权限
chmod +x build/simd

# 或以管理员权限运行
sudo ./build/simd start
```

## 下一步

恭喜！您已经成功完成了 Cosmos SDK 的快速入门。现在您可以：

### 1. 深入学习

- **阅读官方文档**: 访问 https://docs.cosmos.network/
- **查看教程**: 参考 https://tutorials.cosmos.network/
- **研究示例**: 分析 `simapp` 中的代码实现

### 2. 实践项目

- **创建自定义模块**: 基于 `simapp` 开发自己的业务逻辑
- **部署测试网络**: 在云服务器上运行真实的测试网络
- **集成 IBC**: 学习跨链通信协议

### 3. 社区参与

- **加入 Discord**: https://discord.com/invite/interchain
- **关注 GitHub**: 关注 Cosmos SDK 的最新动态
- **贡献代码**: 参与开源社区建设

### 4. 进阶主题

- **智能合约**: 集成 CosmWasm
- **治理机制**: 实现 DAO 功能
- **性能优化**: 调整共识参数和网络配置
- **安全审计**: 学习区块链安全最佳实践

记住，区块链开发是一个持续学习的过程。从简单的概念开始，逐步深入复杂的技术细节。祝您在 Cosmos 生态系统的开发之旅中取得成功！